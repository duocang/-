一.数据库设计的概念

数据库设计是将数据库中的数据实体及这些数据实体之间的关系,进行规划和结构化的过程.

二.数据库设计的重要性

如果一个数据库没有进行一个良好的设计,那么这个数据库完成之后他的缺点是:

1.效率会很低

2更新和检索数据时会出现很多问题,

反之,一个数据库被尽心策划了一番,具有良好的设计,那他的优点是:

1.效率会很高.

2.便于进一步扩展.

3.使得应用程序的开发变得更容易.

三.设计数据库的步骤

1.需求分析阶段:分析客户的业务和数据处理需求.

2.概要设计阶段:他主要就是绘制数据库的E-R图.

3.详细设计阶段:应用数据库的三大范式进行审核数据库的结构.

总结:在进行数据库的系统分析时,都以下列4点位参考的基本步骤.

01.收集信息.

02.标识实体.

03.标识每个实体需要储存的详细信息.

04.标识实体之间的关系.

四.学会绘制E-R图

绘制E-R图首先要了解什么是实体,什么是属性,什么是联系.

1.首先实体是指现实世界中具有区分其他事物的特征或属性与其他实体有联系的实体,针对于数据库中的表而言实体是指表中一行一行特定数据,但我们在开发中,也常常把整个表称为一个实体.

2.属性可以理解为实体的特征,针对于数据库中的表而言实体是指表中的列.

3.联系是两个或多个实体之间的关联关系.

4.实体关系图:
![](/Users/song/OneDrive/第五学期/硕士论文/plot/er.png)

例:酒店管理系统E-R图:
![](/Users/song/OneDrive/第五学期/硕士论文/plot/酒店er.png)

相信我，我写完了，你读完了，你我都失声痛哭！

包括我自己在内的很多人或许从没有认真地思考过“关系型数据库”中的关系二字怎么理解。人们往往觉得设计或者构建数据库的工作完全可以交给小秘去干（虽然根本没有小秘）。**GO FUCK YOURSELF!**

####若要被视为数据库，则存放数据的地方不仅需要保存数据，还要保存数据间的关系信息。


**实体**就是我们存储的数据，例如一个演唱会或者医生的预约。

##基本数据关系
一旦你对数据库中的基本实体有了想法，那么你的下一个任务就是确定实体间的关系。目前有可能会遇到三种实体关系：

+ 一对一(1:1)
+ 一对多(1:n)
+ 多对多(n:n)

心中谨记：**提及的关系，是实例间的关系**。客户是一个实体，张三是客户的一个实例；书是一个实体，《金瓶梅》是书的一个实例。只有张三可以和《金瓶梅》发生关系，而客户和书都是实体，是抽象，至少我不同意。同时，**关系也不是强制发生的**。正如李四是一个客户的实例，但是他完全可能不买任何书，而只买光盘。那么李四和书的实例没有关系。我的天啊，我都在说些什么！这还是在说技术？

### 一对一关系
城市和机场都是实体，一个小城市 C 的机场 J 可以被描述为**“这个机场坐落在一个并且是唯一的一个城市，这个城市有且仅有一个机场。”**这就是一个典型的一对一关系，因为无论是城市C不可能和其他机场发生关系，机场J亦如是。

噫吁戏，一对一在现实中并不多见。如果你发现自己正在处理一个一对一关系（比如妹子答应你去吃饭），记得多扇自己几个大嘴巴子并告诉自己工头一会就要过来派砖头了。

### 一对多关系
这是最常见的关系（被你追的妹子是那个“一”。。。。）**这种关系不知强制建立的**，交易自由，买卖不成仁义在！

### 多对多关系

这种关系也很常见。一个糙汉可以同时追很多妹子，一个妹子同时被巨多糙汉追。还是要记住，**这种关系不知强制建立的**，完全有可能出现糙汉不追妹子追汉子的情况。

从汉子的角度看，一个汉字面对多个妹子；从妹子的角度看，一个妹子有多个汉字追。



### 弱实体和强关系
此前多次提及，关系的非必要性。一个实体完全可能没有关系。但是在某些情况这种情况是不存在的，如张三的《金瓶梅》订单JPM。张三没有这个订单可以存在，但是订单JPM必须依赖张三存在。因而订单这是实体就被叫做***弱实体***，它们之间的关系也被称为***强关系***。确定数据库中的弱关系和强联系对维护连续性和整体性至关重要。

### 

实体关系图（Entity-relationship diagrams, ER/ERD）由Dr. Peter P.S Chen(估计是个华人)发明。ER图比较流行。

![](/Users/song/OneDrive/第五学期/硕士论文/plot/er.png)

例:酒店管理系统E-R图:
![](/Users/song/OneDrive/第五学期/硕士论文/plot/酒店er.png)

### 同多对多关系打交道
数据库设计中多对多关系有两大问题：

+ 关系数据模型无法直接处理多对多关系，囿于一对一和一对多关系。你可能需要将多对多关系分解为一群一对一和一对多关系，如果你使用关系型DBMS的话；
+ 有点难，我举一个🌰。一个订单里可以有多种商品（每种商品的数量会变化），而一种商品（数量可变）又可以包含在多个订单中，这是一个多对多关系。问题是：购买的商品的数量包含在哪里？它不可以包含在***订单***实体中，因为商品的数量还取决于***某一中商品***；也不可以包含在***商品***实体中，因为没有订单哪来的商品和商品数量？

这个尴尬被称为***关系数据***，此数据作用于两个实体之间的关系，而非实体们自己。然而，关系是不能有属性啊。我们由此有必要定义一个实体来完成两个实体关系的定义，从而让该数据依附。

在关系型数据库中，必须使用中间表来表示多对多关系。中间表可以分为两种，一种纯粹表示**关系的中间表**，一种是表示**中间实体的表**。

纯粹表示关系的中间表很简单，只需要两列：汉子ID和妹子ID，汉子ID以外键关联到汉子表，妹子ID以外键关联到妹子表，**然后汉子ID和妹子ID组成联合主键**。这个中间件纯粹表示关系，在业务上不会有实体与它对应。

在中间关系表的基础上加上更多的属性，从而形成一个新的实体。

+ 珍爱网档案号 *（主键）*
+ 汉子ID
+ 妹子ID
+ ~~交配~~交往时间

这就是一个中间实体，已经完全脱离了普通的多对多中间表，而变成了一个实体的形式存在。

### 复合实体
复合实体的存在是为了表达两个或以上实体间的关系。如上述的订单-商品关系，我们需要的是一个实体告诉我们一个具体订单的具体标题。三个订单订购了五种商品。中间一层包含了五种***复合实体***，称之为"***单项产品***"(line item，类似流水单上的一项)。这一层的出现只是为了表示订单和商品间的关系。

订单和line item的关系就是一对多，商品和line item的关系是一对多。必要的时候，line item可以存储关系数据，如数量、是否发货等等。
![](/Users/song/OneDrive/第五学期/硕士论文/plot/关系实体.jpeg)
ER图中，复合实体如下所示：
![](/Users/song/OneDrive/第五学期/硕士论文/plot/复合实体.png)

### 数据模型 VS 数据流
***数据流***在一个组织中被处理，包括了谁处理了数据、哪里存储数据以及数据做了哪些操作。相反，***数据模型***描述了数据的内部、逻辑关系，二不关系谁动了数据或怎么动了数据。